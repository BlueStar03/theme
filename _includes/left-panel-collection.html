<!-- expects include.item -->
{% assign sorted    = site[include.item.collection] | sort: "order" %}
{% assign index_doc = sorted[0] %}
{% assign rest_docs = sorted | slice: 1, sorted.size %}

<li class="collapsible-section">
  <button
    class="collapsible-toggle"
    aria-expanded="false"
    data-key="collection-{{ include.item.collection }}"
    data-index-url="{{ index_doc.url | relative_url }}"
  >
    {{ include.item.title }}
  </button>
  <ul class="collapsible-content">
    {% assign grouped = rest_docs | group_by: "dir" %}
    {% for group in grouped %}
      {% assign folder = group.name | replace: "/", "" %}
      <li class="folder-group">
        {% if folder != "" %}
          <strong>{{ folder }}</strong>
        {% endif %}
        <ul>
          {% for doc in group.items %}
            <li>
              <a href="{{ doc.url | relative_url }}">{{ doc.title }}</a>
            </li>
          {% endfor %}
        </ul>
      </li>
    {% endfor %}
  </ul>
</li>
